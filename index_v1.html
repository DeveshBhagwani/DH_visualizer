<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DH Parameters Educational Tool</title>
    <link rel="stylesheet" href="style_v1.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
</head>
<body class="bg-gray-900 text-white">
    <div class="container mx-auto p-4">
        <header class="mb-8 text-center">
            <h1 class="text-4xl font-bold text-blue-400 mb-2">DH Parameters Educational Tool</h1>
            <p class="text-lg text-gray-300">Learn, visualize, and experiment with Denavit-Hartenberg parameters</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Panel: Controls and DH Table -->
            <div class="bg-gray-800 rounded-lg p-4">
                <div class="mb-6">
                    <h2 class="text-xl font-semibold mb-4 text-blue-300">Robot Configuration</h2>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">Robot Preset</label>
                        <select id="preset-select" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white">
                            <option value="custom">Custom</option>
                            <option value="2link">2-Link Planar</option>
                            <option value="3r">3R Articulated</option>
                            <option value="scara">SCARA</option>
                            <option value="6dof">6-DOF Simplified</option>
                        </select>
                    </div>
                    
                    <div class="flex space-x-2 mb-4">
                        <button id="add-joint" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded">Add Joint</button>
                        <button id="remove-joint" class="flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded">Remove Joint</button>
                    </div>
                </div>

                <div class="mb-6">
                    <h2 class="text-xl font-semibold mb-4 text-blue-300">DH Parameters Table</h2>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="bg-gray-700">
                                    <th class="px-2 py-1 text-left">Joint</th>
                                    <th class="px-2 py-1 text-left">Type</th>
                                    <th class="px-2 py-1 text-left">a</th>
                                    <th class="px-2 py-1 text-left">α</th>
                                    <th class="px-2 py-1 text-left">d</th>
                                    <th class="px-2 py-1 text-left">θ</th>
                                </tr>
                            </thead>
                            <tbody id="dh-table-body">
                                <!-- DH table rows will be populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="mb-6">
                    <h2 class="text-xl font-semibold mb-4 text-blue-300">Display Options</h2>                    
                    <div class="space-y-2">
                        <div class="flex items-center">
                            <input type="checkbox" id="show-frames" class="mr-2" checked>
                            <label for="show-frames">Show Coordinate Frames</label>
                        </div>                        
                        <div class="flex items-center">
                            <input type="checkbox" id="show-labels" class="mr-2" checked>
                            <label for="show-labels">Show Parameter Labels</label>
                        </div>                        
                        <div class="flex items-center">
                            <input type="checkbox" id="show-robot" class="mr-2" checked>
                            <label for="show-robot">Show Robot Geometry</label>
                        </div>                        
                        <div class="flex items-center">
                            <input type="checkbox" id="show-common-normal" class="mr-2">
                            <label for="show-common-normal">Show Common Normals</label>
                        </div>
                    </div>
                </div>
                <div class="mb-6">
                    <h2 class="text-xl font-semibold mb-4 text-blue-300">Animation Controls</h2>                    
                    <div class="flex space-x-2 mb-4">
                        <button id="play-btn" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded">Play</button>
                        <button id="pause-btn" class="flex-1 bg-yellow-600 hover:bg-yellow-700 text-white py-2 rounded">Pause</button>
                        <button id="reset-btn" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-2 rounded">Reset</button>
                    </div>                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">Animation Speed</label>
                        <input type="range" id="speed-slider" min="1" max="10" value="5" class="w-full">
                    </div>                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">Explainer Mode</label>
                        <select id="explainer-mode" class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white">
                            <option value="none">None</option>
                            <option value="stepwise">Step-by-Step</option>
                            <option value="continuous">Continuous</option>
                        </select>
                    </div>
                </div>

                <div class="mb-6">
                    <h2 class="text-xl font-semibold mb-4 text-blue-300">Export Options</h2>
                    
                    <div class="flex space-x-2">
                        <button id="export-csv" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white py-2 rounded">Export CSV</button>
                        <button id="share-url" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 rounded">Share URL</button>
                    </div>
                </div>
            </div>

            <!-- Center Panel: 3D Visualization -->
            <div class="bg-gray-800 rounded-lg p-4 lg:col-span-2">
                <div class="mb-4 flex justify-between items-center">
                    <h2 class="text-xl font-semibold text-blue-300">3D Visualization</h2>
                    <div class="flex space-x-2">
                        <button id="toggle-2d" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1 rounded">2D View</button>
                        <button id="toggle-3d" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded">3D View</button>
                    </div>
                </div>
                
                <div id="visualization-container" class="bg-gray-900 rounded h-96 mb-4 relative overflow-hidden">
                    <div id="canvas-container" class="w-full h-full"></div>
                    
                    <div id="step-instruction" class="absolute bottom-4 left-4 bg-black bg-opacity-70 p-4 rounded max-w-md hidden">
                        <h3 class="text-lg font-semibold mb-2">Step-by-Step Guide</h3>
                        <p id="step-text" class="text-sm"></p>
                        <div class="flex justify-between mt-3">
                            <button id="prev-step" class="bg-gray-600 hover:bg-gray-500 text-white px-3 py-1 rounded">Previous</button>
                            <button id="next-step" class="bg-blue-600 hover:bg-blue-500 text-white px-3 py-1 rounded">Next</button>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-700 rounded p-4">
                        <h3 class="text-lg font-semibold mb-2 text-blue-300">End Effector Pose</h3>
                        <div class="text-sm">
                            <div class="flex justify-between mb-1">
                                <span>Position (x, y, z):</span>
                                <span id="end-effector-pos">(0.00, 0.00, 0.00)</span>
                            </div>
                            <div class="flex justify-between mb-1">
                                <span>Orientation (r, p, y):</span>
                                <span id="end-effector-rot">(0.00, 0.00, 0.00)</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-700 rounded p-4">
                        <h3 class="text-lg font-semibold mb-2 text-blue-300">Transformation Matrix</h3>
                        <div id="transform-matrix" class="text-xs font-mono bg-gray-800 p-2 rounded overflow-auto max-h-32">
                            <!-- Matrix will be populated by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Panel: Explanations and Interactive Content -->
        <div class="mt-6 bg-gray-800 rounded-lg p-4">
            <div class="flex border-b border-gray-700 mb-4">
                <button class="tab-button active px-4 py-2 font-medium" data-tab="explanation">Explanation</button>
                <button class="tab-button px-4 py-2 font-medium" data-tab="interactive">Interactive Quiz</button>
                <button class="tab-button px-4 py-2 font-medium" data-tab="code">Code View</button>
                <button class="tab-button px-4 py-2 font-medium" data-tab="confusions">Common Confusions</button>
            </div>
            
            <div id="explanation" class="tab-content active">
                <h2 class="text-xl font-semibold mb-4 text-blue-300">DH Parameters Explained</h2>
                
                <div class="mb-6">
                    <h3 class="text-lg font-medium mb-2">What are DH Parameters?</h3>
                    <p class="mb-3">The Denavit-Hartenberg (DH) parameters are a standardized way to represent the geometry of robotic arms and other kinematic chains. They use four parameters to describe the relationship between consecutive joint coordinate frames:</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div class="bg-gray-700 p-3 rounded">
                            <h4 class="font-medium text-orange-400 mb-1">a (Link Length)</h4>
                            <p>The distance along the common normal between two joint axes.</p>
                        </div>
                        <div class="bg-gray-700 p-3 rounded">
                            <h4 class="font-medium text-purple-400 mb-1">α (Link Twist)</h4>
                            <p>The angle between two joint axes, measured around the common normal.</p>
                        </div>
                        <div class="bg-gray-700 p-3 rounded">
                            <h4 class="font-medium text-teal-400 mb-1">d (Joint Offset)</h4>
                            <p>The distance along the joint axis between two common normals.</p>
                        </div>
                        <div class="bg-gray-700 p-3 rounded">
                            <h4 class="font-medium text-blue-400 mb-1">θ (Joint Angle)</h4>
                            <p>The angle between two common normals, measured around the joint axis.</p>
                        </div>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h3 class="text-lg font-medium mb-2">Step-by-Step Frame Assignment</h3>
                    <ol class="list-decimal pl-5 space-y-2">
                        <li>Identify and label all joint axes (z<sub>i</sub>)</li>
                        <li>Establish the base frame (z<sub>0</sub> along first joint axis)</li>
                        <li>For each consecutive joint:
                            <ul class="list-disc pl-5 mt-1">
                                <li>Locate the origin where the common normal intersects z<sub>i</sub></li>
                                <li>Establish x<sub>i</sub> along the common normal</li>
                                <li>Establish y<sub>i</sub> to complete the right-handed coordinate system</li>
                            </ul>
                        </li>
                        <li>For the end effector, set the origin and orientation as needed</li>
                    </ol>
                </div>
                
                <div>
                    <h3 class="text-lg font-medium mb-2">Transformation Matrix</h3>
                    <p class="mb-2">The homogeneous transformation matrix from frame i-1 to frame i is given by:</p>
                    <div class="bg-gray-700 p-3 rounded text-center mb-4">
                        <p class="text-lg">T<sub>i</sub> = Rot<sub>z</sub>(θ<sub>i</sub>) × Trans<sub>z</sub>(d<sub>i</sub>) × Trans<sub>x</sub>(a<sub>i</sub>) × Rot<sub>x</sub>(α<sub>i</sub>)</p>
                    </div>
                    <p>This matrix multiplication chains together the four fundamental transformations defined by the DH parameters.</p>
                </div>
            </div>
            
            <div id="interactive" class="tab-content hidden">
                <h2 class="text-xl font-semibold mb-4 text-blue-300">Interactive Quiz</h2>
                
                <div class="mb-6">
                    <h3 class="text-lg font-medium mb-2">Match the Parameter</h3>
                    <p class="mb-4">Drag each parameter name to its correct description:</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div class="space-y-4">
                            <div class="bg-gray-700 p-3 rounded cursor-move" draggable="true" data-param="a">
                                <span class="font-medium text-orange-400">a (Link Length)</span>
                            </div>
                            <div class="bg-gray-700 p-3 rounded cursor-move" draggable="true" data-param="alpha">
                                <span class="font-medium text-purple-400">α (Link Twist)</span>
                            </div>
                            <div class="bg-gray-700 p-3 rounded cursor-move" draggable="true" data-param="d">
                                <span class="font-medium text-teal-400">d (Joint Offset)</span>
                            </div>
                            <div class="bg-gray-700 p-3 rounded cursor-move" draggable="true" data-param="theta">
                                <span class="font-medium text-blue-400">θ (Joint Angle)</span>
                            </div>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="bg-gray-700 p-3 rounded drop-zone" data-correct="a">
                                <p>The distance along the common normal between the z-axes of two consecutive joints</p>
                            </div>
                            <div class="bg-gray-700 p-3 rounded drop-zone" data-correct="alpha">
                                <p>The angle between the z-axes of two consecutive joints, measured about the common normal</p>
                            </div>
                            <div class="bg-gray-700 p-3 rounded drop-zone" data-correct="d">
                                <p>The distance along the joint axis from the common normal of the previous joint to the common normal of the current joint</p>
                            </div>
                            <div class="bg-gray-700 p-3 rounded drop-zone" data-correct="theta">
                                <p>The angle between the common normals of two consecutive joints, measured about the joint axis</p>
                            </div>
                        </div>
                    </div>
                    
                    <div id="quiz-feedback" class="hidden p-3 rounded text-center"></div>
                    
                    <button id="check-quiz" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">Check Answers</button>
                    <button id="reset-quiz" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded ml-2">Reset Quiz</button>
                </div>
            </div>
            
            <div id="code" class="tab-content hidden">
                <h2 class="text-xl font-semibold mb-4 text-blue-300">Code Implementation</h2>
                
                <div class="mb-4">
                    <p class="mb-2">Below is a JavaScript implementation of the DH parameter transformation:</p>
                    <button id="copy-code" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded mb-4">Copy to Clipboard</button>
                </div>
                
                <pre id="code-block" class="bg-gray-900 p-4 rounded text-sm overflow-auto max-h-80">
                    
function dhToTransform(a, alpha, d, theta) {
    const cosTheta = Math.cos(theta);
    const sinTheta = Math.sin(theta);
    const cosAlpha = Math.cos(alpha);
    const sinAlpha = Math.sin(alpha);
    
    return [
        [cosTheta, -sinTheta * cosAlpha, sinTheta * sinAlpha, a * cosTheta],
        [sinTheta, cosTheta * cosAlpha, -cosTheta * sinAlpha, a * sinTheta],
        [0, sinAlpha, cosAlpha, d],
        [0, 0, 0, 1]
    ];
}

function fkChain(dhParams) {
    let transform = [
        [1, 0, 0, 0],
        [0, 1, 0, 0],
        [0, 0, 1, 0],
        [0, 0, 0, 1]
    ];
    
    for (let i = 0; i < dhParams.length; i++) {
        const { a, alpha, d, theta } = dhParams[i];
        const jointTransform = dhToTransform(a, alpha, d, theta);
        transform = multiplyMatrices(transform, jointTransform);
    }
    
    return transform;
}

function multiplyMatrices(a, b) {
    const result = [[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];
    
    for (let i = 0; i < 4; i++) {
        for (let j = 0; j < 4; j++) {
            for (let k = 0; k < 4; k++) {
                result[i][j] += a[i][k] * b[k][j];
            }
        }
    }
    
    return result;
}
                </pre>
            </div>
            
            <div id="confusions" class="tab-content hidden">
                <h2 class="text-xl font-semibold mb-4 text-blue-300">Common Confusions</h2>
                
                <div class="space-y-4">
                    <div class="bg-gray-700 p-4 rounded">
                        <h3 class="text-lg font-medium mb-2 text-yellow-400">Link Length (a) vs Joint Offset (d)</h3>
                        <p><span class="font-medium text-orange-400">Link Length (a)</span> is the distance between joint axes along their common normal. <span class="font-medium text-teal-400">Joint Offset (d)</span> is the distance along the joint axis between two common normals. Remember: a is perpendicular to the joint axis, d is parallel to it.</p>
                    </div>
                    
                    <div class="bg-gray-700 p-4 rounded">
                        <h3 class="text-lg font-medium mb-2 text-yellow-400">When is a parameter zero?</h3>
                        <p>If two joint axes intersect, the link length (a) is zero. If two joint axes are parallel, the link twist (α) is zero. If the common normal passes through the previous joint origin, the joint offset (d) is zero.</p>
                    </div>
                    
                    <div class="bg-gray-700 p-4 rounded">
                        <h3 class="text-lg font-medium mb-2 text-yellow-400">Frame assignment is not unique</h3>
                        <p>There are multiple valid ways to assign coordinate frames following the DH convention. The choice affects the parameter values but not the final transformation. The standard DH convention used here is the most common, but the modified DH convention also exists.</p>
                    </div>
                    
                    <div class="bg-gray-700 p-4 rounded">
                        <h3 class="text-lg font-medium mb-2 text-yellow-400">Prismatic vs Revolute joints</h3>
                        <p>For revolute joints, θ is the variable and d is constant. For prismatic joints, d is the variable and θ is constant. Make sure to identify the joint type correctly when assigning parameters.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script_v1.js"></script>
</body>

</html>
